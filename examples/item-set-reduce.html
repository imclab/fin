<html>
	<head>
		<title>fin-test</title>
		<style type="text/css" media="screen">
			.task input {
				float: right;
			}
			.task div {
				clear: both;
			}
		</style>
	</head>
	<body>
		
		<div id="template" style="display: none;">

			<div class="task" style="width: 300px">
				<br />
				<div>Type: (( Input type )) </div>
				<div>Sum property: (( Number SUM_PROPERTY )) </div>
			</div>

		</div>
		
		<iframe src="item-set-reduce-frame.html"></iframe>
		<button id="button">Create new item</button>
		<div id="itemsOutput"></div>
		
		<script type="text/javascript" src="../lib/js.io/packages/jsio.js"></script>
		<script type="text/javascript">
			function onConnected() {
				var output = document.getElementById('itemsOutput')
				
				var items = fin.getItemSet({ type: gItemType })
				items.addDependant(function(mutation) {
					
					forEach(mutation.add, function(itemId) {
						if (document.getElementById(itemId)) { return }
						var element = fin.applyTemplate(gTemplateString, itemId)
						element.id = itemId
						output.appendChild(element)
					})
					
					forEach(mutation.remove, function(itemId) {
						var el = document.getElementById(itemId)
						if (el) { el.parentNode.removeChild(el) }
					})
				})
			}
			
			document.getElementById('button').onclick = function() {
				fin.createItem({ type: gItemType })
			}
			
			
		</script>
		<script type="text/javascript" src="item-set-reduce.js"></script>
	</body>
</html>